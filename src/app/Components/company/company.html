<h2>Empresas</h2>

<kendo-grid [data]="gridData" 
    [scrollable]="'none'"
    (edit)="editHandler($event)" 
    (cancel)="cancelHandler($event)"
    (save)="saveHandler($event)" 
    (remove)="removeHandler($event)"
    (add)="addHandler($event)">

    <!-- add button -->
    <ng-template kendoGridToolbarTemplate>
        <button kendoGridAddCommand>Crear nueva</button>
    </ng-template>

    <kendo-grid-column field="idEmpresa" title="ID" width="40"></kendo-grid-column>
    <kendo-grid-column field="codigoEmpresa" title="Código" width="80"></kendo-grid-column>
    <kendo-grid-column field="nombreEmpresa" title="Nombre" width="200"></kendo-grid-column>


    <kendo-grid-column field="idCliente" title="Cliente" width="150">
        <ng-template kendoGridCellTemplate let-dataItem>
                {{buscarCliente(dataItem.idCliente)?.nombreCliente}}
            </ng-template>
            <ng-template kendoGridEditTemplate
            let-dataItem="dataItem"
            let-formGroup="formGroup">
            <kendo-dropdownlist
                [data]="clientes"
                textField="nombreCliente"
                valueField="idCliente"
                [valuePrimitive]="true"
                [(ngModel)]="dataItem.idCliente"
                [formControl]="formGroup.get('idCliente')"
            >
            </kendo-dropdownlist>
        </ng-template>
    </kendo-grid-column>

    <kendo-grid-column field="idInstancia" title="Instancia" width="150">
        <ng-template kendoGridCellTemplate let-dataItem>
                {{buscarInstancia(dataItem.idInstancia)?.nombreInstancia}}
            </ng-template>
            <ng-template kendoGridEditTemplate
            let-dataItem="dataItem"
            let-formGroup="formGroup">
            <kendo-dropdownlist
                [data]="instancias"
                textField="nombreInstancia"
                valueField="idInstancia"
                [valuePrimitive]="true"
                [(ngModel)]="dataItem.idInstancia"
                [formControl]="formGroup.get('idInstancia')"
            >
            </kendo-dropdownlist>
        </ng-template>
    </kendo-grid-column>

    <kendo-grid-column field="activo" title="Activo" editor="boolean" width="80">
        <ng-template kendoGridCellTemplate let-dataItem>
            <input type="checkbox" [checked]="dataItem.activo" disabled/>
        </ng-template>
    </kendo-grid-column>

    <kendo-grid-command-column title="Acciones" width="150">
        <ng-template kendoGridCellTemplate let-isNew="isNew">
            <button kendoGridEditCommand class="k-primary">Modificar</button>
            <button kendoGridRemoveCommand>Eliminar</button>
            <button kendoGridSaveCommand class="k-primary">{{ isNew ? 'Añadir' : 'Guardar' }}</button>
            <button kendoGridCancelCommand>{{ isNew ? 'Descartar' : 'Cancelar' }}</button>
        </ng-template>
    </kendo-grid-command-column>
    
</kendo-grid>